# カードデータ仕様書

## 概要

「上司独裁」ゲームで使用される全カードのデータ定義と仕様。
各カードには一意のIDが割り当てられ、効果と対象が明確に定義されている。

## カード構成

### 勤務カード（50枚）

- **攻撃カード**: 22枚 (`attack_001` ～ `attack_022`)
- **防御カード**: 11枚 (`defense_001` ～ `defense_011`)
- **回復カード**: 10枚 (`recovery_001` ～ `recovery_010`)
- **社長カード**: 7枚 (`president_001` ～ `president_007`)

### 独裁カード（15枚）

- **ID**: `dict_001` ～ `dict_015`
- **対象**: boss（上司専用）、subordinate（部下専用）、all（全員対象）

## 詳細仕様

### 勤務カード効果

#### 攻撃カード

**ID範囲**: `attack_001` ～ `attack_022`

**効果**:

- **部下が使用**: 自身のライフを-1して上司に1ダメージ
- **上司が使用**: 部下1人に2ダメージ

**実装ポイント**:

- 部下は自傷ダメージが先に適用される
- 上司は対象選択が必要

#### 防御カード

**ID範囲**: `defense_001` ～ `defense_011`

**効果**:

- **部下が使用**:
  1. 場に出してターン中ダメージ1軽減（ターン終了時に捨札）
  2. 手札から直接使用でダメージ1軽減（複数枚同時使用可能）
- **上司が使用**: 手札から直接使用でダメージ1軽減（複数枚同時使用可能）

**実装ポイント**:

- 部下のみ場に出す使用法が可能
- 複数枚の同時使用をサポート

#### 回復カード

**ID範囲**: `recovery_001` ～ `recovery_010`

**効果**:

- **部下が使用**:
  1. 部下陣営プレイヤー1人のライフを1回復（ライフ0・4は対象外）
  2. 自身のライフが0の時、サイコロ偶数で復活（ライフ1）
- **上司が使用**: 自身のライフを2回復（最大7まで）

**実装ポイント**:

- 部下の復活効果はサイコロ判定が必要
- 上司の回復は上限チェックが必要

#### 社長カード

**ID範囲**: `president_001` ～ `president_007`

**効果**:

- 自陣営の場に配置（永続効果）
- ターン終了時に以下から選択:
  1. プレイヤー1人に1ダメージ
  2. プレイヤー1人のライフを1回復（ライフ0は対象外）
- 2ターン経過後に捨札に置く

**制限**:

- 場に1枚まで（新しい社長が出ると古い社長は捨札）

### 独裁カード効果

#### 上司専用カード（8枚）

| ID         | カード名           | 効果                                                             |
| ---------- | ------------------ | ---------------------------------------------------------------- |
| `dict_001` | 「サボり」スポット | ターン開始時の山札ドローをスキップしてライフ2回復                |
| `dict_002` | 俺の手柄           | サイコロ4以上で山札から社長を場に出す                            |
| `dict_005` | 連帯責任           | 攻撃カードでダメージを与えた時、追加で他プレイヤー1人に1ダメージ |
| `dict_006` | 横領               | ターン開始時に1枚多く山札を引く                                  |
| `dict_007` | 始末書             | ライフ1回復 または 部下1人に1ダメージ を選択                     |
| `dict_010` | 現場の責任         | このターン中に1度だけ受けるダメージを0にできる                   |
| `dict_014` | ルールは破ろう     | 回復カード使用時に攻撃カードも1枚追加で使用可能                  |
| `dict_015` | 上司独裁           | 攻撃カードで与えるダメージ+100                                   |

#### 全員対象カード（7枚）

| ID         | カード名       | 効果                                                 |
| ---------- | -------------- | ---------------------------------------------------- |
| `dict_003` | 水も飲まずに   | ライフ回復した部下に1ダメージ                        |
| `dict_004` | 朝まで飲み会   | 上司ターン終了時に全員に1ダメージ                    |
| `dict_008` | 担当部署の消失 | このターン中部下は防御カードを使用できない           |
| `dict_009` | 有給休暇       | ライフ回復したプレイヤーは手札を1枚捨てる            |
| `dict_011` | あの人の失言   | 場の社長カードを捨札に置く                           |
| `dict_012` | 交戦的な態度   | 各陣営の最初の攻撃カードのダメージ+1                 |
| `dict_013` | たまにはランチ | 社長が捨札にある場合、サイコロで陣営決定して場に出す |

## データ構造

### TypeScript型定義

```typescript
interface WorkCard {
  id: string; // 一意のカードID
  type: 'work'; // カードタイプ
  category: 'attack' | 'defense' | 'recovery' | 'president';
  name: string; // カード名
  description: string; // 効果説明
  isVisible: boolean; // 公開状態
}

interface DictatorshipCard {
  id: string; // 一意のカードID
  type: 'dictatorship'; // カードタイプ
  category: 'dictatorship'; // カテゴリ
  name: string; // カード名
  description: string; // 効果説明
  target: 'boss' | 'subordinate' | 'all'; // 対象
  isVisible: boolean; // 公開状態（常にtrue）
}
```

### ID命名規則

- **勤務カード**: `{category}_{number:3桁}`
  - 例: `attack_001`, `defense_011`, `recovery_010`, `president_007`
- **独裁カード**: `dict_{number:3桁}`
  - 例: `dict_001`, `dict_015`

## 実装ユーティリティ

### CardUtils

```typescript
// カード検索
CardUtils.findById('attack_001'); // IDでカード取得
CardUtils.filterByCategory('attack'); // カテゴリでフィルタ

// デッキ操作
CardUtils.createInitialDeck(); // 初期デッキ作成
CardUtils.shuffleDeck(cards); // デッキシャッフル

// 独裁カード
CardUtils.getRandomDictatorshipCard(); // ランダム独裁カード
CardUtils.getCardTargets(card, role); // カード対象判定
```

## ゲーム内での使用

### デッキ構成

1. **勤務カード50枚**をシャッフルして山札作成
2. **独裁カード15枚**を別途シャッフル
3. 各ターン開始時に独裁カードを1枚公開

### 手札配布

- **上司**: 勤務カード7枚
- **部下**: 勤務カード2枚ずつ

### カード効果の適用順序

1. 独裁カード効果（ターン開始時）
2. プレイヤーアクション（カード使用）
3. 社長カード効果（ターン終了時）
4. 独裁カード継続効果

## バリデーション

### カード使用条件

- 手札に存在するか
- 現在のターンプレイヤーか
- カード使用制限に引っかからないか
- 対象が有効か

### 効果適用チェック

- ライフの上下限チェック
- 場のカード枚数制限
- サイコロ結果の検証
- ダメージ軽減の計算

## テストデータ

### 開発用固定デッキ

```typescript
const TEST_DECK = [
  CardUtils.findById('attack_001'),
  CardUtils.findById('defense_001'),
  CardUtils.findById('recovery_001'),
  CardUtils.findById('president_001'),
  // ...
];
```

### デバッグ用独裁カード

```typescript
const DEBUG_DICTATORSHIP = CardUtils.findById('dict_015'); // 上司独裁
```

## 将来の拡張

### 新カード追加時の考慮事項

1. ID命名規則の維持
2. 型定義の拡張
3. バリデーション関数の更新
4. テストケースの追加
5. ドキュメントの更新

### カスタムカード対応

- プレイヤー作成カードのサポート
- 動的効果定義システム
- カードバランス調整機能
